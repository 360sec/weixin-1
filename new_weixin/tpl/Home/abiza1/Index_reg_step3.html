<layout name="common/html" />

<style type="text/css">
.menu_top ul{padding: 0 10px;}
.menu_top ul li:FIRST-CHILD {display: none;}
.footer{color:#3a3838;font-size: 13px;background: none;margin-top:62px;}
</style>

<div class="container reg_page">
	<div class="col-md-6 reg_left">
		
	</div>
	<div class="col-md-6">
		<form id="regform" class="form" action="/index.php?m=Users&amp;a=checkreg" method="post">
			<div>
				<div class="input_title" for="area">地域</div>
			    <div class="input_text" >
		    		<select class="region_ctrl" name="province" id="province" onChange="items_filter(this)"  style=" width:167px;margin-bottom:30px;"></select>
                     
               		<select class="region_ctrl" name="city" id="city" onChange="items_filter(this)" style=" width:167px;margin-bottom:30px;"></select>
                   
                	<select class="region_ctrl" name="district" id="district" onChange="items_filter(this)" style=" width:167px;margin-bottom:30px;"></select>
                     
			    </div>
			</div>
			<div>   
			    <div class="input_title" for="community">社区门户</div>
			    <div class="input_text">
					<select class="region_ctrl" name="community" id="community" style="width:167px;margin-bottom:30px;"></select>
			    </div>
			</div>
			<div class=" ">
				<button type="submit" id="save-btn" class="btn-save">确定</button>
				<button type="cancel" id="skip-btn" class="btn-skip">跳过</button>
			</div>     
		</form>
	</div>	
</div>

<script type="text/javascript">
			
	var data = {province:{ZF::json_encode($province_data)},
				city:{ZF::json_encode($city_data)},
				district:{ZF::json_encode($district_data)},
				community:{ZF::json_encode($community_data)}}
	
	function items_filter( select ){
		
		var autoload_select_id = null;
		var autoload_data = null;
		
		switch ($(select).attr("id")){
			case "province":
				autoload_select_id = "city";
				autoload_data = data.city;
				break;
			case "city":
				autoload_select_id = "district";
				autoload_data = data.district;
				break;	
			case "district":
				autoload_select_id = "community";
				autoload_data = data.community;
				break;
		}
		
		$("#"+autoload_select_id).empty();
		$(autoload_data).each(function (i){
			
			var p_id = null;
			switch ($(select).attr("id")){
				case "province":
					p_id = this.province_id;
					break;
				case "city":
					p_id = this.city_id;
					break;	
				case "district":
					p_id = this.district_id;
					break;
			}
			
			if ( $(select).find("option:selected").val() == p_id ) 
			$("#"+autoload_select_id).append("<option value='"+this.id+"'>"+this.name+"</option>");
			
		});
		
		if (autoload_select_id != "community")
		items_filter( $("#"+autoload_select_id)[0] );
		
	}
	
	// 区域数据 初始化显示
	$(data.province).each(function (i){
		$("#province").append("<option value='"+this.id+"'>"+this.name+"</option>");
	});
	
	$("#province").change();
	
	function addItem( title,type, p_id ){
		
		//art.dialog.data('goodslist_id',goodslist_id);
		//art.dialog.data('call_back',call_back);
		art.dialog.open('{ZF::U('Home/Region/addregionitem')}&type='+type+'&pid='+p_id, {
			title: title,
			width: '50%',
		    height: '50%',
		    left: '50%',
		    top: '50%',
		    fixed: true,
		    resize: false,
		    drag: false});
	}
</script>