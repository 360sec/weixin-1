<include file="Public:header"/>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>注册</title>
<script type="text/javascript" src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script> 
<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.2/css/bootstrap-theme.css">
<script type="text/javascript" src="http://cdn.bootcss.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<style style="text/css">

body{font-family: '微软雅黑';}
#res_title{ padding-top:20px;padding-bottom:10px;width:300px;margin:0 auto;border-bottom: 1px solid #ccc;margin-bottom:10px;}
#res_title span{font-size:16px;color:#666;padding-bottom:10px;font-weight:bold;padding-left:10px;}
#res{background:#fff;margin-bottom:20px;}
.res-box{font-size:16px;text-align: center;margin:0 auto;margin-bottom: 10px;}
.res-box tr{margin-bottom:20px;line-height:30px;}
.res-but{margin-top:20px;text-align: center;margin:0 auto;margin-top:20px;}
.submit input{width:255px;}
input{margin-bottom: 10px;margin-top:10px;}

</style>
<script type="text/javascript" src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script> 
</head>
<body>
<div id="res_title">
	<span>注册</span>
</div>
<div class="container"  id="res">
	<form method="post">
		<table width="300px" class="res-box">
			<tr>
				<td colspan="2" style="color:red;text-align:center;font-size:14px;">{ZF:$error}</td>
			</tr>
			<tr>
				<td style="text-align:center;">手机号：</td>
				<td><input type="tel" name="phone" id="phone" placeholder="请填写手机号码" height="40px"></td>
			</tr>
			<tr>
				<td></td>
				<td align="left" style="padding-left:15px;"><input type="button" id="getcode_btn" value="发送验证码到手机"></td>
			</tr>
			<tr>
				<td style="text-align:center;">验证码：</td>
				<td><input type="text" name="code" onchange="checkcode(this.value);" placeholder="请输入验证码" height="40px" width="100%"><span id="checkcode_rs"></span></td>
			</tr>
			<tr>
				<td style="text-align:center;">登录密码：</td>
				<td><input type="text" name="password" id="password" placeholder="请输入密码" height="40px" width="100%"></td>
			</tr>
			<tr>
				<td style="text-align:center;">确认密码：</td>
				<td><input type="text" name="password_c" onchange="checkpw(this.value,'password','checkpw_rs');" placeholder="请确认密码" height="40px" width="100%"><span id="checkpw_rs"></span></td>
			</tr>
		</table>
		<table class="res-but">
			<tr style="text-align:center;">
				<td><input type="submit" value="注册" style="background:red;width:300px;height:35px;border:0;box-shadow:1px 1px 1px 1px;font-size:16px;"></td>
			</tr>
		</table>
		
	</form>
	
	<div style="text-align:center;margin-bottom:20px;margin-top:20px;">
		你可以去<a href="{ZF::U('Index/index')}">首页</a> 或者 <a href="{ZF::U('login')}">登录</a>
	</div>
</div>

<script type="text/javascript">
function getcode(){
	$(this).attr('disabled',true);
	var btn = this;
	var btn_value_bak = btn.value;
	
	$.get('{ZF::U('Xiaoqu/People/getcode')}',{phone:$('#phone').val()},
	  function(data){
		btn.value = data;
	  });
	//开始倒数
	var sec = 60;	
	function countsec(){
    	btn.value = sec+"秒后可以重新发送验证码";
    	sec--;
    	if (sec > 0){
    		setTimeout(countsec,1000);
    	}else{
    		btn.value = btn_value_bak;
    		$(btn).attr('disabled',false);
    	}
    }
	
	setTimeout(countsec, 1000);
	
}

function checkcode(code){
	$.get('{ZF::U('Xiaoqu/People/checkcode')}',
			  function(data){
			    if (data == code) {
			    	$('#phone').attr('readonly',true);
			    	$('#checkcode_rs').html('<span style="color:green;">填写正确</span>');
			    }
			    else  $('#checkcode_rs').html('<span style="color:red;">验证码不正确</span>');
			  });
}

function checkpw(value,domid,msgid){
	if (value == $('#'+domid).val()) $('#'+msgid).html('<span style="color:green;">填写正确</span>');
	else $('#'+msgid).html('<span style="color:red;">两次填写的密码不一致!</span>');
}


$("#getcode_btn").bind("click",getcode);
</script>
<include file="Public:footer"/>
</body>
</html>